<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Using Git To Sync Obsidian Notes on iOS with a-shell (free)</title><meta name=description content="Embedded Software Engineer"><meta name=author content="Chris Woodall"><link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css integrity=sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2 crossorigin=anonymous><link rel=stylesheet href=/sass/researcher.min.css><style>img{max-width:100%}</style><link rel=icon type=image/ico href=/favicon.ico><script src=https://unpkg.com/mermaid@8.9.1/dist/mermaid.min.js></script></head><body><div class="container mt-5"><nav class="navbar navbar-expand-sm flex-column flex-sm-row text-nowrap p-0"><a class="navbar-brand mx-0 mr-sm-auto" href=/>Chris Woodall</a><div class="navbar-nav flex-row flex-wrap justify-content-center"><a class="nav-item nav-link" href=/now>Now</a>
<span class="nav-item navbar-text mx-1">/</span>
<a class="nav-item nav-link" href=/posts>Blog</a>
<span class="nav-item navbar-text mx-1">/</span>
<a class="nav-item nav-link" href=/reading>Read</a>
<span class="nav-item navbar-text mx-1">/</span>
<a class="nav-item nav-link" href=/generative-art-studio>Art</a>
<span class="nav-item navbar-text mx-1">/</span>
<a class="nav-item nav-link" href=/climbing>Climb</a>
<span class="nav-item navbar-text mx-1">/</span>
<a class="nav-item nav-link" href=/music>Music</a>
<span class="nav-item navbar-text mx-1">/</span>
<a class="nav-item nav-link" href=/projects>Projects</a>
<span class="nav-item navbar-text mx-1">/</span>
<a class="nav-item nav-link" href=/resume.pdf>Resume</a></div></nav></div><hr><div id=content><link rel=stylesheet href=/css/syntax.css><div class=container><h1 align=center>Using Git To Sync Obsidian Notes on iOS with a-shell (free)</h1><div align=center>Chris Woodall | 2022-01-02</div><img src=/img/posts/2022-01-02-obsidian-ios-sync.md/banner.png><br><p>Obsidian is a wonderful note-taking too, but until mid-2021 there was no official mobile application. I use git to host my Obsidian vaults, and github to store them and sometimes create websites from them using a GitHub Action, GitHub Pages and Neuron. This is how I host my <a href=https://cwoodall.com/generative-art-studio/>Generative Art Studio</a> page. However, on iOS there is no native support for using git to sync your notes. You can use iCloud, or Obsidian Sync. I have no issues with paying for either of these services, but I wanted to be able to keep my current workflow, but extend it to mobile.</p><p>I developed a free method using <a href=https://holzschu.github.io/a-Shell_iOS><strong>a-shell</strong></a>, which can be automated, after initial setup, using iOS Shortcuts. There are two other methods that are well documented on the <a href=https://forum.obsidian.md>Obsidian forum</a>:</p><ul><li><a href=https://forum.obsidian.md/t/mobile-setting-up-ios-git-based-syncing-with-mobile-app-using-working-copy/16499>WorkingCopy</a>: WorkingCopy is a paid application, which runs</li><li><a href=https://forum.obsidian.md/t/mobile-sync-with-git-on-ios-for-free-using-ish/20861/8>iSH</a>: iSH runs an alpine linux container, and this method works. However, it does not have shortcut access, so you would need to launch the application and run git manually.</li></ul><p>This method uses <a href=https://holzschu.github.io/a-Shell_iOS><strong>a-shell</strong></a>, which uses webAssembly for many of it&rsquo;s executables, which allows it to be more flexible, this has support for python, lua, javascript, C and C++, and most importantly git, using lg2. The main benefit is it is free (iSH is also free), and it is natively scriptable using Shortcuts (which iSH is not).</p><p>So let&rsquo;s get started.</p><h3 id=install-the-software>Install the software</h3><ol><li>Install <a href=https://apps.apple.com/us/app/obsidian-connected-notes/id1557175442>Obsidian from the AppStore</a> and launch it.</li><li>Install <a href=https://apps.apple.com/us/app/a-shell/id1473805438>a-shell from the AppStore</a>. We will be using this and a few of it&rsquo;s built in shortcuts such as <code>pickFolder</code> and the <code>lg2</code> (which is based on <a href=https://github.com/libgit2/libgit2>libgit2</a>)</li></ol><h3 id=setup-your-ssh-keys-and-git-configuration>Setup your ssh keys and git configuration:</h3><ol><li>Launch a-shell.</li><li>Mount the Obsidian directory you will be doing your work within. This will be the Obsidian folder : <code>pickFolder</code><embed src="/img/posts/2022-01-02-obsidian-ios-sync.md/2022-01-02 18-03-48.mp4" autostart=false height=300 width=100%></emb><ul><li>WARNING: In the above video I use an iCloud folder. I do not recommend this. After a week of using this on my iPad and iPhone I started running into issues here.</li></ul></li><li>Create an ssh key using <code>ssh-keygen</code>. At this time GitHub no longer supports SHA-1 so we will need to use an ED25519 key.<div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>ssh-keygen -t ed25519 -C <span class=s2>&#34;user@email.com&#34;</span>
</span></span></code></pre></div></li><li>Share the public key with your github or gitlab accounts you need to clone from.</li><li>Clone your obsidian vault:
<code>lg2 clone ssh://git@github.com:blah/blah.git folder-name</code>
This will prompt you for which ssh key you want to use. We will fix that in the next step. You will be prompted to enter your ssh password, if there is none press return.</li><li><code>cd folder-name</code></li><li>Setup <code>user.identityFile</code> and user configurations. This will set the default identity file to use, as well as the name and email address to sign the commits with. These are setup per repository with lg2 as it does not seem to have <code>--global</code> configuration access.<div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>lg2 config user.identityFile ~/Documents/.ssh/id_ed25519
</span></span><span class=line><span class=cl>lg2 config user.password <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>lg2 config user.name <span class=s2>&#34;Name&#34;</span>
</span></span><span class=line><span class=cl>lg2 config user.email <span class=s2>&#34;email@email.com&#34;</span>
</span></span></code></pre></div></li><li>Open up Obsidian, you should see the vault in you list of vaults if you saved it into the correct location.</li></ol><h3 id=setup-shortcuts>Setup Shortcuts</h3><p>Setup shortcuts for <code>pulling</code> (download changes only), and syncing (<code>pulling, committing, and then pushing</code>). Here are the two that I created</p><h4 id=pull-onlyhttpswwwicloudcomshortcutsf609283a61ff44b8af1057b78c025c8f><a href=https://www.icloud.com/shortcuts/f609283a61ff44b8af1057b78c025c8f>Pull Only</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>pickFolder
</span></span><span class=line><span class=cl>lg2 pull
</span></span></code></pre></div><img src=/img/posts/2022-01-02-obsidian-ios-sync.md/shortcut-pull.png width=200px><h4 id=synchttpswwwicloudcomshortcutsf609283a61ff44b8af1057b78c025c8f><a href=https://www.icloud.com/shortcuts/f609283a61ff44b8af1057b78c025c8f>Sync</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>pickFolder
</span></span><span class=line><span class=cl>lg2 pull
</span></span><span class=line><span class=cl>lg2 add .
</span></span><span class=line><span class=cl>lg2 commit -m <span class=s2>&#34;update: {{date}}&#34;</span>
</span></span><span class=line><span class=cl>lg2 push
</span></span></code></pre></div><img src=/img/posts/2022-01-02-obsidian-ios-sync.md/shortcut-sync.png width=200px><p>So long as you keep a strict discipline of pulling before making changes, and pushing changes from your Linux, Mac and Windows Obsidian instances frequently, this setup is pretty stable. It is a little additional step to manually trigger the sync shortcuts, when compared to a solution like Obsidian Sync, or iCloud which are all passive. If you end up with merge conflicts you will need to manually resolve them using <code>lg2</code>. This can be tricky because it diverges from <code>git</code> sometimes, and I found the documentation sparse.</p><p>Here is an example of the shortcuts in action:</p><p><embed src="/img/posts/2022-01-02-obsidian-ios-sync.md/2022-01-02 18-06-40.mp4" autostart=false height=300 width=100%></emb></p></div></div><div id=footer class=mb-5><hr><div class="container text-center"><a href=https://github.com/ojroques/hugo-researcher><small>Built with Hugo and the Hugo Researcher Theme</small></a></div></div></body></html>